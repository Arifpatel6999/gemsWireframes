<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSR Gems - Educational Programs for Children</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
        }

        /* Navigation */
        nav {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 1rem 2rem;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            color: white;
            font-size: 1.8rem;
            font-weight: bold;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background 0.3s;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .page {
            display: none;
            margin-top: 80px;
            min-height: 100vh;
            padding: 2rem 0;
        }

        .page.active {
            display: block;
        }

        /* Homepage Styles */
        .hero {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            text-align: center;
            padding: 4rem 2rem;
            border-radius: 10px;
            margin-bottom: 3rem;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        .hero p>span:hover {
            cursor: pointer;
            text-decoration: underline;
        }

        .btn {
            background: #667eea;
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: transform 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        /* Kiosks Section */
        .filters {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .filter-group input,
        .filter-group select {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .kiosk-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .kiosk-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .kiosk-card:hover {
            transform: translateY(-5px);
        }

        .kiosk-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .kiosk-content {
            padding: 1.5rem;
        }

        /* Admin Panel Styles */
        .admin-header {
            background: #2c3e50;
            color: white;
            padding: 1rem 2rem;
            margin: -2rem -2rem 2rem -2rem;
        }

        .admin-nav {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .admin-nav button {
            background: #34495e;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
        }

        .admin-nav button.active {
            background: #3498db;
        }

        .admin-section {
            display: none;
        }

        .admin-section.active {
            display: block;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: bold;
        }

        /* Calendar Styles */
        .calendar {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #ddd;
        }

        .calendar-day {
            background: white;
            padding: 1rem;
            min-height: 80px;
            position: relative;
        }

        .calendar-day.has-event {
            background: #e3f2fd;
        }

        .event-dot {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 10px;
            height: 10px;
            background: #3498db;
            border-radius: 50%;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 2rem;
            width: 90%;
            max-width: 800px;
            border-radius: 10px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            float: right;
            font-size: 2rem;
            cursor: pointer;
            color: #aaa;
        }

        .close:hover {
            color: #000;
        }

        /* Login Form */
        .login-container {
            max-width: 400px;
            margin: 5rem auto;
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .text-success {
            color: #27ae60;
        }

        .text-danger {
            color: #e74c3c;
        }

        .mb-2 {
            margin-bottom: 1rem;
        }

        .mt-2 {
            margin-top: 1rem;
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav id="mainNav">
        <div class="nav-container">
            <a href="#" class="logo" onclick="showPage('home')">TSR Gems</a>
            <ul class="nav-links" id="publicNav">
                <li><a href="#" onclick="showPage('home')">Home</a></li>
                <li><a href="#" onclick="showPage('kiosks')">Past Kiosks</a></li>
                <li><a href="#" onclick="showPage('upcoming')">Upcoming Kiosks</a></li>
                <li><a href="#" onclick="showPage('contact')">Contact</a></li>
                <li><a href="#" onclick="showLogin()">Admin Login</a></li>
            </ul>
            <ul class="nav-links hidden" id="adminNav">
                <li><a href="#" onclick="showPage('admin')">Dashboard</a></li>
                <li><a href="#" onclick="logout()">Logout</a></li>
            </ul>
        </div>
    </nav>

    <!-- Homepage -->
    <div id="home" class="page active">
        <div class="container">
            <div class="hero">
                <h1>Welcome to TSR Gems</h1>
                <p>Empowering children through innovative educational programs and interactive kiosks</p>
                <p>A <span>TheStrongRope</span> Initiative</p>
                <a href="#" class="btn" onclick="showPage('upcoming')">View Upcoming Kiosks</a>
            </div>

            <div class="features">
                <div class="feature-card">
                    <h3>Interactive Learning</h3>
                    <p>Hands-on educational experiences designed to engage and inspire young minds through interactive
                        kiosks and programs.</p>
                </div>
                <div class="feature-card">
                    <h3>Expert Guidance</h3>
                    <p>Our experienced team creates age-appropriate content that makes learning fun and memorable for
                        children.</p>
                </div>
                <div class="feature-card">
                    <h3>Community Impact</h3>
                    <p>Building stronger communities through educational outreach and fostering a love for learning in
                        children.</p>
                </div>
            </div>

            <div style="text-align: center; margin: 3rem 0;">
                <h2>Our Mission</h2>
                <p style="font-size: 1.1rem; max-width: 600px; margin: 1rem auto;">
                    To provide accessible, engaging educational experiences that inspire curiosity and foster learning
                    in children through innovative programs and interactive technologies.
                </p>
            </div>
        </div>
    </div>

    <!-- Past Kiosks -->
    <div id="kiosks" class="page">
        <div class="container">
            <h1>Past Kiosks</h1>

            <div class="filters">
                <h3>Filter Events</h3>
                <div class="filter-group">
                    <input type="text" id="locationFilter" placeholder="Search by location">
                    <input type="date" id="dateFilter">
                    <select id="locFilter">
                        <option value="">All Locations</option>
                        <option value="Bandra">Bandra</option>
                        <option value="Andheri">Andheri</option>
                        <option value="Malad">Malad</option>
                    </select>
                    <button class="btn" onclick="filterKiosks()">Apply Filters</button>
                </div>
            </div>

            <div class="kiosk-grid" id="kioskGrid">
                <!-- Kiosk cards will be populated here -->
            </div>
        </div>
    </div>

    <!-- Upcoming Events -->
    <div id="upcoming" class="page">
        <div class="container">
            <h1>Upcoming Events</h1>

            <div class="calendar">
                <div class="calendar-header">
                    <button class="btn" onclick="previousMonth()">&lt; Previous</button>
                    <h2 id="calendarMonth">January 2024</h2>
                    <button class="btn" onclick="nextMonth()">Next &gt;</button>
                </div>

                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar days will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Contact -->
    <div id="contact" class="page">
        <div class="container">
            <h1>Contact Us</h1>

            <div class="form-grid">
                <div>
                    <h3>Get in Touch</h3>
                    <div class="form-group">
                        <label>Name:</label>
                        <input type="text" id="contactName">
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="contactEmail">
                    </div>
                    <div class="form-group">
                        <label>Message:</label>
                        <textarea id="contactMessage" rows="5"></textarea>
                    </div>
                    <button class="btn" onclick="submitContact()">Send Message</button>
                </div>

                <div>
                    <h3>Contact Information</h3>
                    <p><strong>Address:</strong> 123 Education Street, Learning City, LC 12345</p>
                    <p><strong>Phone:</strong> (555) 123-4567</p>
                    <p><strong>Email:</strong> info@tsrgems.org</p>

                    <h3 style="margin-top: 2rem;">Follow Us</h3>
                    <p>Stay connected with TSR Gems on social media for updates on upcoming events and educational
                        content.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin" class="page">
        <div class="container">
            <div class="admin-header">
                <h1>Admin Dashboard</h1>
                <p>Welcome, <span id="adminUserName">Admin</span> (<span id="adminRole">Super Admin</span>)</p>

                <div class="admin-nav">
                    <button class="active super-admin-only" onclick="showAdminSection('dashboard')">Overview</button>
                    <button class="super-admin-only" onclick="showAdminSection('kiosk-management')">Manage
                        Kiosks</button>
                    <button onclick="showAdminSection('student-registration')">Student Registration</button>
                    <button onclick="showAdminSection('reports')">Reports</button>
                    <button class="super-admin-only" onclick="showAdminSection('admin-management')">Admin
                        Management</button>
                    <button class="super-admin-only" onclick="showAdminSection('settings')">Settings</button>
                </div>
            </div>

            <!-- Dashboard Overview -->
            <div id="dashboard" class="admin-section active">
                <h2>Dashboard Overview</h2>

                <div class="features">
                    <div class="feature-card">
                        <h3>Total Events</h3>
                        <p style="font-size: 2rem; color: #3498db;" id="totalEvents">12</p>
                    </div>
                    <div class="feature-card">
                        <h3>Registered Students</h3>
                        <p style="font-size: 2rem; color: #27ae60;" id="totalStudents">245</p>
                    </div>
                    <div class="feature-card">
                        <h3>Upcoming Events</h3>
                        <p style="font-size: 2rem; color: #f39c12;" id="upcomingEvents">3</p>
                    </div>
                </div>

                <h3>Recent Activity</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Action</th>
                            <th>User</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody id="recentActivity">
                        <tr>
                            <td>2024-01-15</td>
                            <td>New Event Created</td>
                            <td>Super Admin</td>
                            <td>Science Fair 2024</td>
                        </tr>
                        <tr>
                            <td>2024-01-14</td>
                            <td>Student Registered</td>
                            <td>Junior Admin</td>
                            <td>Emma Johnson - Math Workshop</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Kiosk Management -->
            <div id="kiosk-management" class="admin-section">
                <h2>Kiosk Management</h2>

                <div style="margin-bottom: 2rem;">
                    <button class="btn" onclick="showAddKioskForm()">Add Upcoming Kiosk</button>
                    <button class="btn" style="margin-left: 1rem;" onclick="showAddPastKioskForm()">Add Past
                        Kiosk</button>
                </div>

                <table class="data-table" style="margin-top: 2rem;">
                    <thead>
                        <!-- <tr>
                            <th>Event Name</th>
                            <th>Date</th>
                            <th>Location</th>
                            <th>Participants</th>
                            <th>Actions</th>
                        </tr> -->
                    </thead>
                    <tbody id="kioskTable">
                        <!-- Kiosk data will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Student Registration Management -->
            <div id="student-registration" class="admin-section">
                <h2>Student Registration Management</h2>
                <p style="font-weight: 500; margin: 0.5rem 0 1rem 0;">(To Register a Student Activate Any Kiosk)</p>

                <button class="btn" onclick="showStudentRegistration()">Register New Student</button>
                <button class="btn" style="margin-left: 1rem;" onclick="exportStudentData()">Export Data</button>

                <div class="filters" style="margin-top: 2rem;">
                    <div class="filter-group">
                        <input type="text" id="studentSearch" placeholder="Search students...">
                        <select id="eventFilter">
                            <option value="">All Kiosks</option>
                            <option value="Bandra">Bandra</option>
                            <option value="Malad">Malad</option>
                        </select>
                        <button class="btn" onclick="filterStudents()">Filter</button>
                    </div>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Age</th>
                            <th>Father's Name</th>
                            <th>Contact</th>
                            <th>Kiosk</th>
                            <th>Registration Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="studentTable">
                        <!-- Student data will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Reports -->
            <div id="reports" class="admin-section">
                <h2>Reports & Analytics</h2>
                <p style="font-weight: 500; margin: 0.5rem 0 1rem 0;">(Frontend Only - Not fully Funtional)</p>

                <div class="form-grid">
                    <div>
                        <h3>Generate Report</h3>
                        <div class="form-group">
                            <label>Report Type:</label>
                            <select id="reportType">
                                <option value="participation">Kiosk Participation Data</option>
                                <option value="demographics">All Kiosk Data</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Date Range:</label>
                            <input type="date" id="reportStartDate">
                            <input type="date" id="reportEndDate" style="margin-top: 0.5rem;">
                        </div>
                        <div class="form-group">
                            <label>Format:</label>
                            <select id="reportFormat">
                                <option value="pdf">PDF</option>
                                <option value="excel">Excel</option>
                                <option value="csv">CSV</option>
                            </select>
                        </div>
                        <button class="btn" onclick="generateReport()">Generate Report</button>
                    </div>

                    <div>
                        <h3>Quick Stats</h3>
                        <div class="feature-card">
                            <h4>This Month</h4>
                            <p>Events: <strong>4</strong></p>
                            <p>New Registrations: <strong>67</strong></p>
                            <p>Attendance Rate: <strong>94%</strong></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Management -->
            <div id="admin-management" class="admin-section">
                <h2>Admin Management</h2>
                <button class="btn" onclick="showAddUserForm()">Add New User</button>

                <table class="data-table" style="margin-top: 1rem;">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Role</th>
                            <th>Last Login</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="adminUsersTable">
                        <tr>
                            <td>admin</td>
                            <td>Super Admin</td>
                            <td>2024-01-15</td>
                            <td>
                                <button class="btn" style="padding: 0.25rem 0.5rem;"
                                    onclick="editAdmin('admin')">Edit</button>
                                <button class="btn" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;"
                                    onclick="deleteAdmin('admin')">Delete</button>
                            </td>
                        </tr>
                        <tr>
                            <td>junior</td>
                            <td>Junior Admin</td>
                            <td>2024-01-14</td>
                            <td>
                                <button class="btn" style="padding: 0.25rem 0.5rem;"
                                    onclick="editAdmin('junior')">Edit</button>
                                <button class="btn" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;"
                                    onclick="deleteAdmin('junior')">Delete</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Settings -->
            <div id="settings" class="admin-section">
                <h2>System Settings</h2>

                <div class="form-grid">
                    <div>
                        <h3>System Configuration</h3>
                        <div class="form-group">
                            <label>Organization Name:</label>
                            <input type="text" value="TSR Gems" id="orgName">
                        </div>
                        <div class="form-group">
                            <label>Contact Email:</label>
                            <input type="email" value="info@tsrgems.org" id="orgEmail">
                        </div>
                        <button class="btn" onclick="saveSettings()">Save Settings</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('loginModal')">&times;</span>
            <h2>Admin Login</h2>

            <div class="login-container" style="margin: 0; box-shadow: none;">
                <div class="form-group">
                    <label>Username:</label>
                    <input type="text" id="loginUsername" value="admin">
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="loginPassword" value="password">
                </div>
                <button class="btn" onclick="login()" style="width: 100%;">Login</button>

                <div style="margin-top: 1rem; font-size: 0.9rem; color: #666;">
                    <p><strong>Demo Credentials:</strong></p>
                    <p>Super Admin: admin / password</p>
                    <p>Junior Admin: junior / password</p>
                </div>
            </div>
        </div>
    </div>



    <!-- Student Registration Modal -->
    <div id="studentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('studentModal')">&times;</span>
            <h2>Student Registration</h2>

            <form id="studentForm">
                <div class="form-grid">
                    <div>
                        <div class="form-group">
                            <label>Student Name:</label>
                            <input type="text" id="studentName" required>
                        </div>
                        <div class="form-group">
                            <label>Age:</label>
                            <input type="number" id="studentAge" required>
                        </div>
                        <div class="form-group">
                            <label>Parent/Guardian Name:</label>
                            <input type="text" id="fatherName" required>
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>Contact Phone:</label>
                            <input type="tel" id="contactPhone" required>
                        </div>
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" id="contactEmailStudent">
                        </div>
                        <div class="form-group">
                            <label>Select Event:</label>
                            <select id="selectedEvent" required>
                                <option value="">Choose an event...</option>
                                <option value="Bandra">Bandra</option>
                                <option value="Malad">Malad</option>
                                <option value="Andheri">Andheri</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Special Notes:</label>
                    <textarea id="specialNotes" rows="3"
                        placeholder="Notes about islamic class madarsa/tanzeem"></textarea>
                </div>

                <button type="button" class="btn" onclick="registerStudent()">Register Student</button>
            </form>
        </div>
    </div>

    <!-- Add Kiosk Modal -->
    <div id="addKioskModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addKioskModal')">&times;</span>
            <h2>Add New Kiosk Event</h2>

            <form id="kioskForm">
                <div class="form-grid">
                    <div>
                        <div class="form-group">
                            <label>Event Name:</label>
                            <input type="text" id="kioskName" required>
                        </div>
                        <div class="form-group">
                            <label>Date:</label>
                            <input type="date" id="kioskDate" required>
                        </div>
                        <div class="form-group">
                            <label>Location:</label>
                            <input type="text" id="kioskLocation" required>
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>Duration (hours):</label>
                            <input type="number" id="duration" min="1" step="0.5" required>
                        </div>
                        <div class="form-group">
                            <label>Age Group:</label>
                            <select id="ageGroup" required>
                                <option value="">Select age group...</option>
                                <option value="upto_14">upto_14</option>
                                <option value="above_14">above_14</option>
                                <option value="all">All ages</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="kioskDescription" rows="4" required
                        placeholder="Describe the event activities and learning objectives..."></textarea>
                </div>

                <div class="form-group">
                    <label>Upload Materials:</label>
                    <input type="file" id="kioskMaterials" multiple accept=".pdf,.mp3,.mp4,.jpg,.png">
                    <small style="color: #666;">Upload narration files, images, or PDF materials</small>
                </div>

                <button type="button" class="btn" onclick="saveKiosk()">Save Kiosk Event</button>
            </form>
        </div>
    </div>

    <!-- student Registration Admin -->
    <div id="studentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('studentModal')">&times;</span>
            <h2>Student Registration</h2>

            <form id="studentForm">
                <div class="form-grid">
                    <div>
                        <div class="form-group">
                            <label>Student Name*:</label>
                            <input type="text" id="studentName" required>
                        </div>
                        <div class="form-group">
                            <label>Father's Name*:</label>
                            <input type="text" id="fatherName" required>
                        </div>
                        <div class="form-group">
                            <label>Age*:</label>
                            <input type="number" id="studentAge" min="5" max="18" required>
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>Contact Number*:</label>
                            <input type="tel" id="contactPhone" required pattern="[0-9]{10}">
                        </div>
                        <div class="form-group">
                            <label>Address*:</label>
                            <textarea id="address" required rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Select Kiosk*:</label>
                            <select id="selectedKiosk" required>
                                <option value="">Select a kiosk...</option>
                                <option value="Bandra">Bandra Kiosk</option>
                                <option value="Malad">Malad Kiosk</option>
                                <option value="Andheri">Andheri Kiosk</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Has the student joined our class before?*</label>
                    <div style="display: flex; gap: 1rem; margin-top: 0.5rem;">
                        <label><input type="radio" name="previousClass" value="yes" required> Yes</label>
                        <label><input type="radio" name="previousClass" value="no"> No</label>
                        <label><input type="radio" name="previousClass" value="other"> Other</label>
                    </div>
                </div>

                <div class="form-group" id="specialCommentsGroup" style="display: none;">
                    <label>Special Comments:</label>
                    <textarea id="specialComments" rows="2"></textarea>
                </div>

                <div class="form-group" style="margin-top: 1rem;">
                    <label>
                        <input type="checkbox" id="consentCheckbox" required>
                        I consent to my child participating in TSR Gems educational programs*
                    </label>
                </div>

                <button type="button" class="btn" onclick="registerStudent()"
                    style="width: 100%; margin-top: 1rem;">Register Student</button>
            </form>
        </div>
    </div>

    <!-- Event Detail Modal -->
    <div id="eventDetailModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('eventDetailModal')">&times;</span>
            <div id="eventDetailContent">
                <!-- Event details will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Global variables for data storage (simulating database)
        let currentUser = null;
        let currentPage = 'home';
        let currentMonth = new Date();

        // Activity logs for admin dashboard
        let activityLogs = [
            {
                date: new Date().toISOString(),
                action: 'System Initialized',
                user: 'System',
                details: 'Application started'
            }
        ];

        // Admin users data store
        let adminUsers = [
            {
                id: 1,
                username: 'admin',
                password: 'password',
                role: 'Super Admin',
                lastLogin: new Date().toISOString()
            },
            {
                id: 2,
                username: 'junior',
                password: 'password',
                role: 'Junior Admin',
                lastLogin: new Date().toISOString()
            }
        ];

        // Sample data
        let kiosksData = [
            {
                id: 1,
                name: "Bandra kiosk",
                date: "2024-01-10",
                location: "Bandra",
                duration: 4,
                description: `
ðŸ“š Hadees Yaad Karo, Inaam Jeeto! ðŸŽ

âœ¨ GHADEER - KIOSK âœ¨
TSR Ki Taraf Se - Hadeesen Yaad Karne Ka Muqabla

Ye Profram Sirf Ladkon Ke Liye Tha

ðŸŽ Bachho Ne Hadeeth Yaad ki Aur Unko Inamaat diye gaye ðŸŽ

TSR Gems team
==============
ðŸª€ Updates ke liye WhatsApp  Community Join Karen: https://c....
                `,
                participants: 45,
                ageGroup: "All ages",
                materials: ["experiment_guide.pdf", "narration.mp3"],
                feedback: 4.8,
                images: ["science1.jpg", "science2.jpg"],
                isActive: true,
                completed: true,
            },
            {
                id: 2,
                name: "Malad kiosk",
                date: "2024-01-05",
                location: "Malad",
                duration: 3,
                description: `
ðŸ“š Hadees Yaad Karo, Inaam Jeeto! ðŸŽ

âœ¨ GHADEER - KIOSK âœ¨
TSR Ki Taraf Se - Hadeesen Yaad Karne Ka Muqabla

Ye Profram Sirf Ladkon Ke Liye Tha

ðŸŽ Bachho Ne Hadeeth Yaad ki Aur Unko Inamaat diye gaye ðŸŽ

TSR Gems team
==============
ðŸª€ Updates ke liye WhatsApp  Community Join Karen: https://c....
                `,
                participants: 32,
                ageGroup: "All ages",
                materials: ["art_instructions.pdf"],
                feedback: 4.6,
                images: ["art1.jpg", "art2.jpg"],
                isActive: true,
                completed: true
            },
            {
                id: 3,
                name: "Andheri kiosk",
                date: "2024-01-08",
                location: "Andheri",
                duration: 2,
                description: `
ðŸ“š Hadees Yaad Karo, Inaam Jeeto! ðŸŽ

âœ¨ GHADEER - KIOSK âœ¨
TSR Ki Taraf Se - Hadeesen Yaad Karne Ka Muqabla

Ye Profram Sirf Ladkon Ke Liye Tha

ðŸŽ Bachho Ne Hadeeth Yaad ki Aur Unko Inamaat diye gaye ðŸŽ

TSR Gems team
==============
ðŸª€ Updates ke liye WhatsApp  Community Join Karen: https://c....
                `,
                participants: 28,
                ageGroup: "All ages",
                materials: ["math_puzzles.pdf", "solution_guide.pdf"],
                feedback: 4.7,
                images: ["math1.jpg"],
                isActive: true,
                completed: true
            }
        ];

        let studentsData = [
            {
                id: 1,
                name: "Emma Johnson",
                age: 10,
                fatherName: "Sarah Johnson",
                phone: "(555) 123-4567",
                email: "sarah.johnson@email.com",
                event: "Bandra",
                registrationDate: "2024-01-12",
                specialNotes: "Goes to Aims"
            },
            {
                id: 2,
                name: "Michael Chen",
                age: 8,
                fatherName: "David Chen",
                phone: "(555) 987-6543",
                email: "david.chen@email.com",
                event: "Malad",
                registrationDate: "2024-01-11",
                specialNotes: "Goes to TSR"
            }
        ];

        let upcomingEvents = [
            {
                id: 4,
                name: "Mumbra kiosk",
                date: `${currentMonth.getFullYear().toString()}-${String(currentMonth.getMonth() + 1).padStart(2, '0')}-${String(15).padStart(2, '0')}`,
                location: "Mumbra",
                description: `
ðŸ“š Hadees Yaad Karo, Inaam Jeeto! ðŸŽ

âœ¨ GHADEER - KIOSK âœ¨
TSR Ki Taraf Se - Hadeesen Yaad Karne Ka Muqabla

Sirf Ladkon Ke Liye

Insha'Allah
ðŸ—“ï¸ 22-Jun-2025 (example)
ðŸ•— Dopahar: 3 Bajay se
ðŸ•Œ 24-J, Zakir Hussain Nagar, Govandi, Mumbai- 43

ðŸŽ Common Prize Sab ke liye honge ðŸŽ

TSR Gems team
==============
ðŸª€ Updates ke liye WhatsApp  Community Join Karen: https://c....
                `,
                isActive: false,
                completed: false
            },
            {
                id: 5,
                name: "Govandi Kiosk",
                date: `${currentMonth.getFullYear().toString()}-${String(currentMonth.getMonth() + 1).padStart(2, '0')}-${String(20).padStart(2, '0')}`,
                location: "Govandi",
                description: `
ðŸ“š Hadees Yaad Karo, Inaam Jeeto! ðŸŽ

âœ¨ GHADEER - KIOSK âœ¨
TSR Ki Taraf Se - Hadeesen Yaad Karne Ka Muqabla

Sirf Ladkon Ke Liye

Insha'Allah
ðŸ—“ï¸ 22-Jun-2025 (Example)
ðŸ•— Dopahar: 3 Bajay se
ðŸ•Œ 24-J, Zakir Hussain Nagar, Govandi, Mumbai- 43

ðŸŽ Common Prize Sab ke liye honge ðŸŽ

TSR Gems team
==============
ðŸª€ Updates ke liye WhatsApp  Community Join Karen: https://c....
                `,
                isActive: false,
                completed: false
            },
            {
                id: 6,
                name: "Dongri Kiosk",
                date: `${currentMonth.getFullYear().toString()}-${String(currentMonth.getMonth() + 2).padStart(2, '0')}-${String(25).padStart(2, '0')}`,
                location: "Dongri",
                description: `
ðŸ“š Hadees Yaad Karo, Inaam Jeeto! ðŸŽ

âœ¨ GHADEER - KIOSK âœ¨
TSR Ki Taraf Se - Hadeesen Yaad Karne Ka Muqabla

Sirf Ladkon Ke Liye

Insha'Allah
ðŸ—“ï¸ 22-Jun-2025 (Example)
ðŸ•— Dopahar: 3 Bajay se
ðŸ•Œ 24-J, Zakir Hussain Nagar, Govandi, Mumbai- 43

ðŸŽ Common Prize Sab ke liye honge ðŸŽ

TSR Gems team
==============
ðŸª€ Updates ke liye WhatsApp  Community Join Karen: https://c....
                `,
                isActive: false,
                completed: false
            }
        ];

        // Navigation functions
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            currentPage = pageId;

            // Load page-specific content
            if (pageId === 'kiosks') {
                loadKiosks();
            } else if (pageId === 'upcoming') {
                loadCalendar();
            } else if (pageId === 'admin') {
                loadAdminDashboard();
                loadUserManagementTable();
            }
        }

        function showAdminSection(sectionId) {
            document.querySelectorAll('.admin-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.admin-nav button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Load section-specific content
            if (sectionId === 'kiosk-management') {
                loadKioskManagement();
            } else if (sectionId === 'student-registration') {
                loadStudentManagement();
            } else if (sectionId === 'admin-management') {
                refreshAdminTable();
            }
        }

        // Admin Management Functions
        function refreshAdminTable() {
            const tableBody = document.getElementById('adminUsersTable');
            if (!tableBody) return;

            tableBody.innerHTML = '';
            adminUsers.forEach(admin => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${admin.username}</td>
                    <td>${admin.role}</td>
                    <td>${new Date(admin.lastLogin).toLocaleDateString()}</td>
                    <td>
                        <button class="btn" style="padding: 0.25rem 0.5rem;" onclick="editAdmin('${admin.username}')">Edit</button>
                        <button class="btn" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;" onclick="deleteAdmin('${admin.username}')">Delete</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function showAddUserForm() {
            const username = prompt('Enter username:');
            if (!username) return;

            const password = prompt('Enter password:');
            if (!password) return;

            const role = prompt('Enter role (Super Admin/Junior Admin):');
            if (!role || !['Super Admin', 'Junior Admin'].includes(role)) {
                alert('Invalid role. Must be "Super Admin" or "Junior Admin"');
                return;
            }

            // Add new admin user
            const newAdmin = {
                id: adminUsers.length + 1,
                username: username,
                password: password,
                role: role,
                lastLogin: new Date().toISOString()
            };

            adminUsers.push(newAdmin);
            refreshAdminTable();
            alert('Admin user added successfully!');
            addActivityLog('Admin Added', `New admin user ${username} added with role ${role}`);
        }

        function deleteAdmin(username) {
            if (username === 'admin') {
                alert('Cannot delete super admin account!');
                return;
            }

            if (confirm(`Are you sure you want to delete admin user "${username}"?`)) {
                const index = adminUsers.findIndex(admin => admin.username === username);
                if (index !== -1) {
                    adminUsers.splice(index, 1);
                    refreshAdminTable();
                    alert('Admin user deleted successfully!');
                    addActivityLog('Admin Deleted', `Admin user ${username} was deleted`);
                }
            }
        }

        function editAdmin(username) {
            const admin = adminUsers.find(a => a.username === username);
            if (!admin) return;

            const newPassword = prompt('Enter new password (leave empty to keep current):');
            if (newPassword) {
                admin.password = newPassword;
            }

            const newRole = prompt('Enter new role (Super Admin/Junior Admin) or leave empty to keep current:');
            if (newRole && ['Super Admin', 'Junior Admin'].includes(newRole)) {
                admin.role = newRole;
            }

            refreshAdminTable();
            alert('Admin user updated successfully!');
            addActivityLog('Admin Updated', `Admin user ${username} was updated`);
        }

        // Authentication functions
        function showLogin() {
            document.getElementById('loginModal').style.display = 'block';
        }

        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            // Simple authentication (in real app, this would be server-side)
            const user = adminUsers.find(u => u.username === username && u.password === password);

            if (user) {
                user.lastLogin = new Date().toISOString();
                currentUser = {
                    id: user.id,
                    username: user.username,
                    role: user.role
                };

                document.getElementById('adminUserName').textContent = username;
                document.getElementById('adminRole').textContent = currentUser.role;

                document.getElementById('publicNav').classList.add('hidden');
                document.getElementById('adminNav').classList.remove('hidden');

                // Handle role-based navigation
                const superAdminElements = document.querySelectorAll('.super-admin-only');
                superAdminElements.forEach(element => {
                    if (user.role === 'Super Admin') {
                        element.style.display = 'inline-block';
                    } else {
                        element.style.display = 'none';
                    }
                });

                closeModal('loginModal');
                // If Junior Admin, redirect to student registration
                if (user.role === 'Junior Admin') {
                    showPage('admin');
                    showAdminSection('student-registration');
                } else {
                    showPage('admin');

                    // Show success message
                    alert('Login successful!');
                }
                addActivityLog('User Login', `${username} logged in as ${user.role}`);
            } else {
                alert('Invalid credentials. Try admin/password or junior/password');
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('publicNav').classList.remove('hidden');
            document.getElementById('adminNav').classList.add('hidden');
            showPage('home');
            alert('Logged out successfully');
        }

        // Modal functions
        function showStudentRegistration() {
            // Check for active kiosks first
            const today = new Date();
            const activeKiosks = upcomingEvents.filter(event =>
                event.isActive && new Date(event.date) >= today
            );

            if (activeKiosks.length === 0) {
                alert('There are no active kiosks available for registration.');
                return; // Exit the function early if no active kiosks
            }

            // If there are active kiosks, proceed with form setup
            const form = document.getElementById('studentForm');
            form.reset();

            // Update event dropdown with active kiosks
            const eventSelect = document.getElementById('selectedEvent');
            eventSelect.innerHTML = ''; // Clear existing options

            // Add a default option
            eventSelect.appendChild(new Option('Select an event', '', true, true));

            // Add active kiosks as options
            activeKiosks.forEach(kiosk => {
                const option = new Option(kiosk.name, kiosk.name);
                eventSelect.appendChild(option);
            });

            document.getElementById('studentModal').style.display = 'block';
            document.getElementById('studentName').focus();
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';

                // Reset any forms inside the modal
                const form = modal.querySelector('form');
                if (form) {
                    form.reset();
                    delete form.dataset.editId;

                    // Reset any submit buttons to their default state
                    const submitButton = form.querySelector('button[type="button"]');
                    if (submitButton) {
                        if (form.id === 'studentForm') {
                            submitButton.textContent = 'Register Student';
                            submitButton.setAttribute('onclick', 'registerStudent()');
                        }
                    }
                }
            }
        }


        // ===== EVENT LISTENERS =====
        document.addEventListener('DOMContentLoaded', function () {
            // Previous class participation radio buttons
            document.querySelectorAll('input[name="previousClass"]').forEach(radio => {
                radio.addEventListener('change', function () {
                    document.getElementById('specialCommentsGroup').style.display =
                        this.value === 'other' ? 'block' : 'none';
                });
            });

            // Close modals when clicking outside
            window.onclick = function (event) {
                const modals = document.getElementsByClassName('modal');
                for (let modal of modals) {
                    if (event.target === modal) {
                        modal.style.display = 'none';
                    }
                }
            }
        });

        function showAddKioskForm(kioskId = null, isPast = false) {
            const modal = document.getElementById('addKioskModal');
            const modalTitle = modal.querySelector('h2');
            const form = document.getElementById('kioskForm');

            // Reset form
            form.reset();

            if (kioskId) {
                // Edit mode
                modalTitle.textContent = 'Edit Kiosk Event';
                const kiosk = kiosksData.find(k => k.id === kioskId);
                if (kiosk) {
                    document.getElementById('kioskName').value = kiosk.name;
                    document.getElementById('kioskDate').value = kiosk.date;
                    document.getElementById('kioskLocation').value = kiosk.location;
                    document.getElementById('duration').value = kiosk.duration;
                    document.getElementById('ageGroup').value = kiosk.ageGroup.toLowerCase().replace(' ', '_');
                    document.getElementById('kioskDescription').value = kiosk.description;
                    // Store kiosk ID and type for update
                    form.dataset.kioskId = kioskId;
                    form.dataset.isPast = kiosk.isPast;
                }
            } else {
                // Add mode
                modalTitle.textContent = isPast ? 'Add Past Kiosk Event' : 'Add Upcoming Kiosk Event';
                delete form.dataset.kioskId;
                form.dataset.isPast = isPast;
            }

            modal.style.display = 'block';
        }

        function showAddPastKioskForm() {
            showAddKioskForm(null, true);
        }


        function editKiosk(kioskId) {
            showAddKioskForm(kioskId);
        }

        // Kiosk management functions
        function loadKiosks() {
            const grid = document.getElementById('kioskGrid');
            grid.innerHTML = '';

            // Only show past kiosks
            const pastKiosks = kiosksData.filter(kiosk => {
                const kioskDate = new Date(kiosk.date);
                const today = new Date();
                return kioskDate < today;
            });

            pastKiosks.map(kiosk => {
                const card = document.createElement('div');
                card.className = 'kiosk-card';
                card.innerHTML = `
                    <div class="kiosk-image">
                        ðŸ“š ${kiosk.location.toUpperCase()}
                    </div>
                    <div class="kiosk-content">
                        <h3>${kiosk.name}</h3>
                        <p><strong>Date:</strong> ${formatDate(kiosk.date)}</p>
                        <p><strong>Location:</strong> ${kiosk.location}</p>
                        <p><strong>Participants:</strong> ${kiosk.participants}</p>
                        <p><pre>${kiosk.description.slice(0, 70) + '...'}</pre></p>
                        <div style="margin-top: 1rem;">
                            <button class="btn" onclick="viewEventDetail(${kiosk.id})" style="padding: 0.5rem 1rem;">View Details</button>
                            <button class="btn" onclick="shareEvent(${kiosk.id})" style="padding: 0.5rem 1rem; margin-left: 0.5rem;">Share</button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function loadKioskManagement() {
            const tableBody = document.getElementById('kioskTable');
            if (!tableBody) return;

            // Create table header if it doesn't exist
            const thead = tableBody.parentElement.querySelector('thead');
            if (!thead.innerHTML) {
                thead.innerHTML = `
                    <tr>
                        <th>Event Name</th>
                        <th>Date</th>
                        <th>Location</th>
                        <th>Participants</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                `;
            }

            // Clear existing rows
            tableBody.innerHTML = '';

            // Combine and sort past and upcoming events
            const combinedKiosks = [...kiosksData, ...upcomingEvents].sort((a, b) => new Date(b.date) - new Date(a.date));

            combinedKiosks.forEach(kiosk => {
                const row = document.createElement('tr');
                const isActive = kiosk.isActive ? 'Active' : 'Inactive';

                // Check if it's a past kiosk by comparing date
                const isPastKiosk = new Date(kiosk.date) < new Date();

                row.innerHTML = `
                    <td>${kiosk.name}</td>
                    <td>${new Date(kiosk.date).toLocaleDateString()}</td>
                    <td>${kiosk.location}</td>
                    <td>${kiosk.participants || 0}</td>
                    <td>${isPastKiosk ? 'Completed' : isActive}</td>
                    <td>
                        <button class="btn" onclick="editKiosk(${kiosk.id})">Edit</button>
                        <button class="btn" onclick="deleteKiosk(${kiosk.id})">Delete</button>
                        ${!isPastKiosk ? `
                        <button class="btn" onclick="toggleKioskStatus(${kiosk.id})">
                            ${kiosk.isActive ? 'Deactivate' : 'Activate'}
                        </button>
                        ` : ''}
                    </td>
                `;
                tableBody.appendChild(row);
            });
            const table = document.getElementById('kioskTable');
            table.innerHTML = `
                <tr>
                    <th>Name</th>
                    <th>Date</th>
                    <th>Location</th>
                    <th>Participants</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            `;

            // Combine past and upcoming kiosks
            const allKiosks = [...kiosksData, ...upcomingEvents].sort((a, b) => new Date(a.date) - new Date(b.date));

            allKiosks.forEach(kiosk => {
                const row = document.createElement('tr');
                // Determine if it's upcoming based on the source array and date
                const isUpcoming = kiosk.isPast === false || (kiosk.date && new Date(kiosk.date) > new Date());
                row.innerHTML = `
                    <td>${kiosk.name}</td>
                    <td>${formatDate(kiosk.date)}</td>
                    <td>${kiosk.location}</td>
                    <td>${kiosk.participants || 0}</td>
                    <td>
                        ${isUpcoming ? `
                        <div class="toggle-switch" style="display: flex; align-items: center; gap: 8px;">
                            <label class="switch" style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                <input type="checkbox" ${kiosk.isActive ? 'checked' : ''} 
                                    onchange="toggleKioskActive(${kiosk.id}, ${isUpcoming}, this.checked)"
                                    style="opacity: 0; width: 0; height: 0;">
                                <span class="slider" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;"></span>
                                <style>
                                    .switch input:checked + .slider {
                                        background-color: #2ecc71;
                                    }
                                    .switch input:checked + .slider:before {
                                        transform: translateX(26px);
                                    }
                                    .slider:before {
                                        position: absolute;
                                        content: "";
                                        height: 16px;
                                        width: 16px;
                                        left: 4px;
                                        bottom: 4px;
                                        background-color: white;
                                        transition: .4s;
                                        border-radius: 50%;
                                    }
                                </style>
                            </label>
                            <span class="status-label" style="color: ${kiosk.isActive ? '#2ecc71' : '#e74c3c'}">
                                ${kiosk.isActive ? 'Active' : 'Inactive'}
                            </span>
                        </div>
                        ` : `
                        <div style="color: #666;">
                            <span>Completed</span>
                        </div>
                        `}
                    </td>
                    <td>
                        <button class="btn" onclick="editKiosk(${kiosk.id}, ${isUpcoming})" style="padding: 0.25rem 0.5rem;">Edit</button>
                        <button class="btn" onclick="deleteKiosk(${kiosk.id}, ${isUpcoming})" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem; background: #e74c3c;">Delete</button>
                        <span class="badge" style="background: ${isUpcoming ? '#2ecc71' : '#e74c3c'}; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; margin-left: 0.5rem;">
                            ${isUpcoming ? 'Upcoming' : 'Past'}
                        </span>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        function loadStudentManagement() {
            const table = document.getElementById('studentTable');
            table.innerHTML = '';

            studentsData.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.name}</td>
                    <td>${student.age}</td>
                    <td>${student.fatherName}</td>
                    <td>${student.phone}</td>
                    <td>${student.event}</td>
                    <td>${formatDate(student.registrationDate)}</td>
                    <td>
                        <button class="btn" onclick="editStudent(${student.id})" style="padding: 0.25rem 0.5rem;">Edit</button>
                        <button class="btn" onclick="deleteStudent(${student.id})" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem; background: #e74c3c;">Delete</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        //update student Table Data

        function updateStudentTableData() {
            const table = document.getElementById('studentTable');

            const row = document.createElement('tr');
            row.innerHTML = `
                    <td>${student.name}</td>
                    <td>${student.age}</td>
                    <td>${student.phone}</td>
                    <td>${student.event}</td>
                    <td>${formatDate(student.registrationDate)}</td>
                    <td>
                        <button class="btn" onclick="editStudent(${student.id})" style="padding: 0.25rem 0.5rem;">Edit</button>
                        <button class="btn" onclick="deleteStudent(${student.id})" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem; background: #e74c3c;">Delete</button>
                    </td>
                `;
            table.appendChild(row);
        }

        // Calendar functions
        function loadCalendar() {
            const grid = document.getElementById('calendarGrid');
            const monthHeader = document.getElementById('calendarMonth');

            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"];

            monthHeader.textContent = `${monthNames[currentMonth.getMonth()]} ${currentMonth.getFullYear()}`;

            grid.innerHTML = '';

            // Add day headers
            const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            dayHeaders.forEach(day => {
                const header = document.createElement('div');
                header.style.background = '#f8f9fa';
                header.style.fontWeight = 'bold';
                header.style.textAlign = 'center';
                header.style.padding = '0.5rem';
                header.textContent = day;
                grid.appendChild(header);
            });

            // Calculate first day of month and number of days
            const firstDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);
            const lastDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startDay = firstDay.getDay();

            // Add empty cells for days before month starts
            for (let i = 0; i < startDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                grid.appendChild(emptyDay);
            }

            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;

                // Check for events on this day
                const currentDate = `${currentMonth.getFullYear()}-${String(currentMonth.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const hasEvent = upcomingEvents.some(event => event.date === currentDate);

                if (hasEvent) {
                    dayElement.classList.add('has-event');
                    const eventDot = document.createElement('div');
                    eventDot.className = 'event-dot';
                    dayElement.appendChild(eventDot);

                    dayElement.onclick = () => showEventsForDate(currentDate);
                    dayElement.style.cursor = 'pointer';
                }

                grid.appendChild(dayElement);
            }
        }

        function previousMonth() {
            currentMonth.setMonth(currentMonth.getMonth() - 1);
            loadCalendar();
        }

        function nextMonth() {
            currentMonth.setMonth(currentMonth.getMonth() + 1);
            loadCalendar();
        }

        function showEventsForDate(date) {
            const events = upcomingEvents.filter(event => event.date === date);
            if (events.length > 0) {
                let content = `<h3>Events on ${formatDate(date)}</h3>`;
                events.forEach(event => {
                    content += `
                        <div style="border: 1px solid #ddd; padding: 1rem; margin: 1rem 0; border-radius: 5px;">
                            <h4>${event.name}</h4>
                            <p><strong>Location:</strong> ${event.location}</p>
                            <p><pre>${event.description}</pre></p>
                            </div>
                            `;
                    // <button class="btn" onclick="showStudentRegistration()">Register for Event</button>
                });

                document.getElementById('eventDetailContent').innerHTML = content;
                document.getElementById('eventDetailModal').style.display = 'block';
            }
        }

        // Form submission functions
        function registerStudent() {
            const formData = {
                id: studentsData.length + 1,
                name: document.getElementById('studentName').value,
                age: parseInt(document.getElementById('studentAge').value),
                fatherName: document.getElementById('fatherName').value,
                phone: document.getElementById('contactPhone').value,
                email: document.getElementById('contactEmailStudent').value,
                event: document.getElementById('selectedEvent').value,
                registrationDate: new Date().toISOString().split('T')[0],
                specialNotes: document.getElementById('specialNotes').value
            };

            // Validate required fields
            if (!formData.name || !formData.age || !formData.fatherName || !formData.phone || !formData.event) {
                alert('Please fill in all required fields');
                return;
            }

            studentsData.push(formData);

            addActivityLog('Student Registration', `${formData.name} registered for ${formData.event}`);
            alert(`Student ${formData.name} registered successfully for ${formData.event}!`);

            // Update dashboard stats immediately
            updateDashboardStats();

            // Reset form and ensure button is in registration mode
            const form = document.getElementById('studentForm');
            const submitButton = form.querySelector('button[type="button"]');

            if (form && submitButton) {
                form.reset();
                delete form.dataset.editId;
                submitButton.textContent = 'Register Student';
                submitButton.setAttribute('onclick', 'registerStudent()');
            }

            // Close the modal
            closeModal('studentModal');

            // Update dashboard stats and refresh table
            updateDashboardStats();
            loadStudentManagement();
        }

        function saveKiosk() {
            const form = document.getElementById('kioskForm');
            const kioskId = form.dataset.kioskId;
            const isPast = form.dataset.isPast === 'true';

            const formData = {
                name: document.getElementById('kioskName').value.trim(),
                date: document.getElementById('kioskDate').value,
                location: document.getElementById('kioskLocation').value.trim(),
                duration: parseFloat(document.getElementById('duration').value),
                ageGroup: document.getElementById('ageGroup').value,
                description: document.getElementById('kioskDescription').value.trim(),
                isPast: isPast
            };

            // Validate required fields
            if (!formData.name || !formData.date || !formData.location ||
                isNaN(formData.duration) || !formData.ageGroup || !formData.description) {
                alert('Please fill in all required fields');
                return;
            }

            // Validate date based on kiosk type
            const today = new Date();
            const kioskDate = new Date(formData.date);
            if (isPast && kioskDate >= today) {
                alert('Past kiosk date must be before today');
                return;
            }
            if (!isPast && kioskDate <= today) {
                alert('Upcoming kiosk date must be after today');
                return;
            }

            // Handle file uploads
            const fileInput = document.getElementById('kioskMaterials');
            const materials = Array.from(fileInput.files).map(file => file.name);

            if (kioskId) {
                // Update existing kiosk
                const parsedId = parseInt(kioskId);
                // Check both arrays to find where the kiosk exists
                let kiosksIndex = kiosksData.findIndex(k => k.id === parsedId);
                let upcomingIndex = upcomingEvents.findIndex(k => k.id === parsedId);

                if (kiosksIndex !== -1) {
                    // Update in past kiosks
                    const existingKiosk = kiosksData[kiosksIndex];
                    kiosksData[kiosksIndex] = {
                        ...existingKiosk,
                        ...formData,
                        materials: materials.length > 0 ? materials : existingKiosk.materials
                    };
                } else if (upcomingIndex !== -1) {
                    // Update in upcoming events
                    const existingKiosk = upcomingEvents[upcomingIndex];
                    upcomingEvents[upcomingIndex] = {
                        ...existingKiosk,
                        ...formData,
                        materials: materials.length > 0 ? materials : existingKiosk.materials
                    };
                }
                addActivityLog('Kiosk Updated', `${formData.name} kiosk details updated`);
                alert(`Kiosk event "${formData.name}" updated successfully!`);
            } else {
                // Create new kiosk
                const allIds = [...kiosksData.map(k => k.id), ...upcomingEvents.map(k => k.id)];
                const newKiosk = {
                    id: allIds.length > 0 ? Math.max(...allIds) + 1 : 1,
                    ...formData,
                    materials: materials,
                    participants: 0,
                    feedback: 0,
                    images: [],
                    isPast: isPast,
                    isActive: isPast ? true : false, // Past kiosks are active (completed), upcoming are inactive by default
                    completed: isPast // Only past kiosks are marked as completed
                };

                if (isPast) {
                    kiosksData.push(newKiosk);
                } else {
                    upcomingEvents.push(newKiosk);
                }
                addActivityLog('Kiosk Created', `New ${isPast ? 'past' : 'upcoming'} kiosk "${formData.name}" created`);
                alert(`Kiosk event "${formData.name}" created successfully!`);
            }

            // Reset form and close modal
            form.reset();
            delete form.dataset.kioskId;
            closeModal('addKioskModal');

            // Refresh views
            loadKioskManagement();
            if (currentPage === 'kiosks') {
                loadKiosks();
            }
            updateDashboardStats();
        }


        function submitContact() {
            const name = document.getElementById('contactName').value;
            const email = document.getElementById('contactEmail').value;
            const message = document.getElementById('contactMessage').value;

            if (!name || !email || !message) {
                alert('Please fill in all fields');
                return;
            }

            alert('Thank you for your message! We will get back to you soon.');

            // Reset form
            document.getElementById('contactName').value = '';
            document.getElementById('contactEmail').value = '';
            document.getElementById('contactMessage').value = '';
        }

        // Filter and search functions
        function filterKiosks() {
            const locationFilter = document.getElementById('locationFilter').value.toLowerCase();
            const dateFilter = document.getElementById('dateFilter').value;
            const locFilter = document.getElementById('locFilter').value;

            let filtered = kiosksData;

            if (locationFilter) {
                filtered = filtered.filter(kiosk =>
                    kiosk.location.toLowerCase().includes(locationFilter)
                );
            }

            if (dateFilter) {
                filtered = filtered.filter(kiosk => kiosk.date === dateFilter);
            }

            if (locFilter) {
                filtered = filtered.filter(kiosk => kiosk.location === locFilter);
            }

            // Re-render filtered results
            const grid = document.getElementById('kioskGrid');
            grid.innerHTML = '';

            filtered.forEach(kiosk => {
                const card = document.createElement('div');
                card.className = 'kiosk-card';
                card.innerHTML = `
                    <div class="kiosk-image">
                        ðŸ“š ${kiosk.location.toUpperCase()}
                    </div>
                    <div class="kiosk-content">
                        <h3>${kiosk.name}</h3>
                        <p><strong>Date:</strong> ${formatDate(kiosk.date)}</p>
                        <p><strong>Location:</strong> ${kiosk.location}</p>
                        <p><strong>Participants:</strong> ${kiosk.participants}</p>
                        <p>${kiosk.description}</p>
                        <div style="margin-top: 1rem;">
                            <button class="btn" onclick="viewEventDetail(${kiosk.id})" style="padding: 0.5rem 1rem;">View Details</button>
                            <button class="btn" onclick="shareEvent(${kiosk.id})" style="padding: 0.5rem 1rem; margin-left: 0.5rem;">Share</button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function filterStudents() {
            const search = document.getElementById('studentSearch').value.toLowerCase();
            const eventFilter = document.getElementById('eventFilter').value;

            let filtered = studentsData;

            if (search) {
                filtered = filtered.filter(student =>
                    student.name.toLowerCase().includes(search) ||
                    student.fatherName.toLowerCase().includes(search)
                );
            }

            if (eventFilter) {
                filtered = filtered.filter(student => student.event === eventFilter);
            }

            // Re-render filtered results
            const table = document.getElementById('studentTable');
            table.innerHTML = '';

            filtered.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.name}</td>
                    <td>${student.age}</td>
                    <td>${student.fatherName}</td>
                    <td>${student.phone}</td>
                    <td>${student.event}</td>
                    <td>${formatDate(student.registrationDate)}</td>
                    <td>
                        <button class="btn" onclick="editStudent(${student.id})" style="padding: 0.25rem 0.5rem;">Edit</button>
                        <button class="btn" onclick="deleteStudent(${student.id})" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem; background: #e74c3c;">Delete</button>
                    </td>
                `;
            });
            table.appendChild(row);
        }

        // Admin functions
        function loadAdminDashboard() {
            // Initial update
            updateDashboardStats();
            updateActivityLogs();

            // // Set up automatic updates every minute
            // if (!window.dashboardUpdateInterval) {
            //     window.dashboardUpdateInterval = setInterval(updateDashboardStats, 60000);
            // }
        }

        function addActivityLog(action, details) {
            activityLogs.unshift({
                date: new Date().toISOString(),
                action: action,
                user: currentUser ? currentUser.username : 'System',
                details: details
            });

            // Keep only the last 100 activities
            if (activityLogs.length > 100) {
                activityLogs = activityLogs.slice(0, 100);
            }

            // Update the activity table if we're on the admin dashboard
            if (currentPage === 'admin') {
                updateActivityLogs();
            }
        }

        function updateActivityLogs() {
            const activityTable = document.getElementById('recentActivity');
            activityTable.innerHTML = '';

            // Show the 10 most recent activities
            const recentActivities = activityLogs.slice(0, 10);

            recentActivities.forEach(activity => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formatDate(activity.date)}</td>
                    <td>${activity.action}</td>
                    <td>${activity.user}</td>
                    <td>${activity.details}</td>
                `;
                activityTable.appendChild(row);
            });
        }

        // Admin user management functions
        function addNewAdmin(username, password, role) {
            const newAdmin = {
                id: adminUsers.length + 1,
                username: username,
                password: password,
                role: role,
                lastLogin: null
            };

            adminUsers.push(newAdmin);
            addActivityLog('Admin Created', `New ${role} account created for ${username} by ${currentUser.username}`);
            alert('New admin user created successfully!');
            // loadUserManagementTable();
            refreshAdminTable();
        }

        function deleteAdmin(username) {
            if (username === 'admin') {
                alert('Cannot delete the super admin account!');
                return;
            }

            if (username === currentUser?.username) {
                alert('You cannot delete your own account');
                return;
            }

            if (confirm(`Are you sure you want to delete the admin user "${username}"?`)) {
                const adminIndex = adminUsers.findIndex(a => a.username === username);
                if (adminIndex !== -1) {
                    adminUsers.splice(adminIndex, 1);
                    addActivityLog('Admin Deleted', `Admin user ${username} was deleted by ${currentUser.username}`);
                    alert('Admin user deleted successfully');
                    refreshAdminTable();
                }
            }
        }

        // Student management functions

        function toggleKioskActive(id, isUpcoming, active) {
            let updated = false;

            // Find and update the kiosk in the appropriate array
            if (isUpcoming) {
                const index = upcomingEvents.findIndex(k => k.id === id);
                if (index !== -1) {
                    upcomingEvents[index].isActive = active;
                    updated = true;
                }
            } else {
                const index = kiosksData.findIndex(k => k.id === id);
                if (index !== -1) {
                    kiosksData[index].isActive = active;
                    updated = true;
                }
            }

            if (updated) {
                // Show feedback to user
                const status = active ? 'activated' : 'deactivated';
                const kiosk = isUpcoming ?
                    upcomingEvents.find(k => k.id === id) :
                    kiosksData.find(k => k.id === id);

                addActivityLog('Kiosk Status Change', `${kiosk.name} has been ${status} by ${currentUser.username}`);
                alert(`${kiosk.name} has been ${status} for student registration.`);

                // Refresh all relevant views
                loadKioskManagement();

                // If the student registration modal is open, refresh its dropdown
                const studentModal = document.getElementById('studentModal');
                if (studentModal && studentModal.style.display === 'block') {
                    updateStudentEventDropdown();
                }
            }
        }

        function updateStudentEventDropdown() {
            const eventSelect = document.getElementById('selectedEvent');
            if (!eventSelect) return;

            const currentValue = eventSelect.value;
            eventSelect.innerHTML = '';

            // Get all active upcoming kiosks
            const today = new Date();
            const activeKiosks = upcomingEvents.filter(event =>
                event.isActive && new Date(event.date) >= today
            );

            if (activeKiosks.length === 0) {
                const option = new Option('No active kiosks available', '', true, true);
                option.disabled = true;
                eventSelect.appendChild(option);
            } else {
                eventSelect.appendChild(new Option('Select an event', '', true, true));
                activeKiosks.forEach(kiosk => {
                    const option = new Option(kiosk.name, kiosk.name);
                    eventSelect.appendChild(option);
                });

                // Restore previously selected value if it's still available
                if (currentValue && activeKiosks.some(k => k.name === currentValue)) {
                    eventSelect.value = currentValue;
                }
            }
        }

        function updateDashboardStats() {
            const today = new Date();

            // Calculate total past events
            const pastEvents = kiosksData.length;

            // Calculate active/upcoming events
            const activeEvents = upcomingEvents.filter(event => new Date(event.date) >= today).length;

            // Calculate total students and active registrations
            const totalStudents = studentsData.length;
            // const activeRegistrations = studentsData.filter(student => {
            //     const event = upcomingEvents.find(e => e.name === student.event);
            //     return event && new Date(event.date) >= today;
            // }).length;

            // Update the stats in real time
            document.getElementById('totalEvents').textContent = pastEvents;
            document.getElementById('totalStudents').textContent = totalStudents;
            document.getElementById('upcomingEvents').textContent = activeEvents;
            // document.getElementById('activeRegistrations').textContent = activeRegistrations;

        }

        function editKiosk(id, isUpcoming) {
            // Check both arrays to find the kiosk
            const kiosk = isUpcoming ? upcomingEvents.find(k => k.id === id) : kiosksData.find(k => k.id === id);
            if (kiosk) {
                const modal = document.getElementById('addKioskModal');
                const modalTitle = modal.querySelector('h2');
                const form = document.getElementById('kioskForm');

                modalTitle.textContent = 'Edit Kiosk Event';

                // Fill form with existing data
                document.getElementById('kioskName').value = kiosk.name;
                document.getElementById('kioskDate').value = kiosk.date;
                document.getElementById('kioskLocation').value = kiosk.location;
                document.getElementById('duration').value = kiosk.duration || '';
                document.getElementById('ageGroup').value = kiosk.ageGroup ? kiosk.ageGroup.toLowerCase().replace(' ', '_') : 'all';
                document.getElementById('kioskDescription').value = kiosk.description;

                // Store kiosk ID and type for update
                form.dataset.kioskId = id;
                form.dataset.isPast = (!isUpcoming).toString();

                modal.style.display = 'block';
            }
        }

        function deleteKiosk(id, isUpcoming) {
            if (confirm('Are you sure you want to delete this kiosk event?')) {
                // First try to find the kiosk in both arrays to determine its actual location
                const isPastKiosk = kiosksData.some(k => k.id === id);
                const isUpcomingKiosk = upcomingEvents.some(k => k.id === id);

                if (isUpcomingKiosk) {
                    upcomingEvents = upcomingEvents.filter(kiosk => kiosk.id !== id);
                } else if (isPastKiosk) {
                    kiosksData = kiosksData.filter(kiosk => kiosk.id !== id);
                }
                loadKioskManagement();
                if (currentPage === 'kiosks') {
                    loadKiosks();
                } else if (currentPage === 'upcoming') {
                    loadCalendar();
                }
                updateDashboardStats();
                alert('Kiosk event deleted successfully');
            }
        }

        function editStudent(id) {
            const student = studentsData.find(s => s.id === id);
            if (student) {
                // Fill the form with student data
                document.getElementById('studentName').value = student.name;
                document.getElementById('studentAge').value = student.age;
                document.getElementById('fatherName').value = student.fatherName;
                document.getElementById('contactPhone').value = student.phone;
                document.getElementById('contactEmailStudent').value = student.email;
                document.getElementById('selectedEvent').value = student.event;
                document.getElementById('specialNotes').value = student.specialNotes || '';

                // Change the form's submit button and add a data attribute
                const form = document.getElementById('studentForm');
                form.dataset.editId = id;
                const submitButton = form.querySelector('button[onclick="registerStudent()"]');
                submitButton.textContent = 'Update Student';
                submitButton.setAttribute('onclick', 'updateStudent()');

                // Show the modal
                document.getElementById('studentModal').style.display = 'block';
            }
        }

        function updateStudent() {
            const form = document.getElementById('studentForm');
            const studentId = parseInt(form.dataset.editId);

            const updatedData = {
                id: studentId,
                name: document.getElementById('studentName').value,
                age: parseInt(document.getElementById('studentAge').value),
                fatherName: document.getElementById('fatherName').value,
                phone: document.getElementById('contactPhone').value,
                email: document.getElementById('contactEmailStudent').value,
                event: document.getElementById('selectedEvent').value,
                registrationDate: studentsData.find(s => s.id === studentId).registrationDate,
                specialNotes: document.getElementById('specialNotes').value
            };

            // Validate required fields
            if (!updatedData.name || !updatedData.age || !updatedData.fatherName || !updatedData.phone || !updatedData.event) {
                alert('Please fill in all required fields');
                return;
            }

            // Update the student data
            const index = studentsData.findIndex(s => s.id === studentId);
            if (index !== -1) {
                studentsData[index] = updatedData;
                alert(`Student ${updatedData.name}'s information updated successfully!`);

                // Update dashboard stats immediately
                updateDashboardStats();

                // Reset form and close modal
                form.reset();
                delete form.dataset.editId;
                const submitButton = form.querySelector('button');
                submitButton.textContent = 'Register Student';
                submitButton.setAttribute('onclick', 'registerStudent()');
                closeModal('studentModal');

                // Refresh the student table
                loadStudentManagement();
            }
        }

        function deleteStudent(id) {
            if (confirm('Are you sure you want to delete this student registration?')) {
                studentsData = studentsData.filter(student => student.id !== id);
                loadStudentManagement();
                // Update dashboard stats immediately
                updateDashboardStats();
                alert('Student registration deleted successfully');
            }
        }

        function viewEventDetail(id) {
            const event = kiosksData.find(k => k.id === id);
            if (event) {
                const content = `
                    <h2>${event.name}</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">
                        <div>
                            <p><strong>Date:</strong> ${formatDate(event.date)}</p>
                            <p><strong>Location:</strong> ${event.location}</p>
                            <p><strong>Duration:</strong> ${event.duration || 'N/A'} hours</p>
                            <p><strong>Age Group:</strong> ${event.ageGroup}</p>
                        </div>
                        <div>
                            <p><strong>Participants:</strong> ${event.participants}</p>
                            <p><strong>Feedback Rating:</strong> ${event.feedback}/5.0 â­</p>
                            <p><strong>Materials:</strong> ${event.materials.length} files</p>
                        </div>
                    </div>
                    <div>
                        <h3>Description</h3>
                        <p><pre>${event.description}</pre></p>
                    </div>
                    <div style="margin-top: 2rem;">
                        <h3>Event Gallery</h3>
                        <div style="display: flex; gap: 1rem;">
                            ${event.images.map(img => `<div style="width: 100px; height: 100px; background: #f0f0f0; border-radius: 5px; display: flex; align-items: center; justify-content: center;">ðŸ“¸</div>`).join('')}
                        </div>
                    </div>
                `;

                document.getElementById('eventDetailContent').innerHTML = content;
                document.getElementById('eventDetailModal').style.display = 'block';
            }
        }

        function shareEvent(id) {
            const event = kiosksData.find(k => k.id === id);
            if (event) {
                const shareText = `Check out this TSR Gems event: ${event.name} at ${event.location} on ${formatDate(event.date)}`;

                if (navigator.share) {
                    navigator.share({
                        title: event.name,
                        text: shareText,
                        url: window.location.href
                    });
                } else {
                    // Fallback - copy to clipboard
                    navigator.clipboard.writeText(shareText).then(() => {
                        alert('Event details copied to clipboard!');
                    });
                }
            }
        }

        // Report functions
        function generateReport() {
            const reportType = document.getElementById('reportType').value;
            const startDate = document.getElementById('reportStartDate').value;
            const endDate = document.getElementById('reportEndDate').value;
            const format = document.getElementById('reportFormat').value;

            if (!startDate || !endDate) {
                alert('Please select date range for the report');
                return;
            }

            alert(`Generating ${reportType} report in ${format.toUpperCase()} format for ${startDate} to ${endDate}... (UI Only)`);

            // In a real application, this would generate and download the actual report
            setTimeout(() => {
                alert('Report generated successfully! Download will start automatically.');
            }, 1500);
        }

        function exportStudentData() {
            const data = studentsData.map(student => ({
                Name: student.name,
                Age: student.age,
                'Parent/Guardian': student.fatherName,
                Phone: student.phone,
                Email: student.email,
                Event: student.event,
                'Registration Date': student.registrationDate,
                'Special Notes': student.specialNotes
            }));

            // Convert to CSV format
            const csv = convertToCSV(data);
            downloadCSV(csv, 'students_data.csv');

            alert("Sample Data Downloaded")
        }

        function convertToCSV(data) {
            if (data.length === 0) return '';

            const headers = Object.keys(data[0]);
            const csvContent = [
                headers.join(','),
                ...data.map(row =>
                    headers.map(header =>
                        JSON.stringify(row[header] || '')
                    ).join(',')
                )
            ].join('\n');

            return csvContent;
        }

        function downloadCSV(csv, filename) {
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', filename);
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function showAddUserForm() {
            // Only Super Admin can add new users
            if (currentUser.role !== 'Super Admin') {
                alert('Only Super Admin can add new users');
                return;
            }

            const modal = document.getElementById('addUserModal');
            if (!modal) {
                // Create modal if it doesn't exist
                const modalHtml = `
                    <div id="addUserModal" class="modal">
                        <div class="modal-content">
                            <span class="close" onclick="closeModal('addUserModal')">&times;</span>
                            <h2>Add New Admin User</h2>
                            <form id="userForm">
                                <div class="form-group">
                                    <label>Username:</label>
                                    <input type="text" id="newUsername" required>
                                </div>
                                <div class="form-group">
                                    <label>Password:</label>
                                    <input type="password" id="newPassword" required>
                                </div>
                                <div class="form-group">
                                    <label>Confirm Password:</label>
                                    <input type="password" id="confirmPassword" required>
                                </div>
                                <div class="form-group">
                                    <label>Role:</label>
                                    <select id="userRole" required>
                                        <option value="">Select role...</option>
                                        <option value="Admin">Admin</option>
                                        <option value="Junior Admin">Junior Admin</option>
                                    </select>
                                </div>
                                <button type="button" class="btn" onclick="addNewUser()">Add User</button>
                            </form>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', modalHtml);
            }

            // Show the modal
            document.getElementById('addUserModal').style.display = 'block';
        }

        function addNewUser() {
            const username = document.getElementById('newUsername').value.trim();
            const password = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const role = document.getElementById('userRole').value;

            // Validate inputs
            if (!username || !password || !confirmPassword || !role) {
                alert('Please fill in all fields');
                return;
            }

            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }

            // Check if username already exists
            if (adminUsers.some(u => u.username === username)) {
                alert('Username already exists');
                return;
            }

            // Add new user
            const newUser = {
                id: adminUsers.length + 1,
                username: username,
                password: password,
                role: role,
                lastLogin: new Date().toISOString()
            };

            adminUsers.push(newUser);
            alert('New admin user added successfully');
            closeModal('addUserModal');
            refreshAdminTable(); // Use refreshAdminTable instead of loadUserManagementTable
            addActivityLog('Admin Created', `New ${role} account created by ${currentUser.username}`);
        }

        function loadUserManagementTable() {
            const table = document.querySelector('#settings table');
            if (!table) return;

            const tbody = table.querySelector('tbody') || table.insertRow();
            tbody.innerHTML = '';

            adminUsers.forEach(user => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${user.username}</td>
                    <td>${user.role}</td>
                    <td>${formatDate(user.lastLogin)}</td>
                    <td>
                        ${user.username !== 'admin' ? `
                            <button class="btn" onclick="deleteUser(${user.id})" style="padding: 0.25rem 0.5rem; background: #e74c3c;">Delete</button>
                        ` : ''}
                    </td>
                `;
            });
        }

        function deleteUser(userId) {
            if (currentUser.role !== 'Super Admin') {
                alert('Only Super Admin can delete users');
                return;
            }

            if (confirm('Are you sure you want to delete this user?')) {
                const index = adminUsers.findIndex(u => u.id === userId);
                if (index !== -1) {
                    adminUsers.splice(index, 1);
                    alert('User deleted successfully');
                    loadUserManagementTable();
                }
            }
        }

        function saveSettings() {
            const orgName = document.getElementById('orgName').value;
            const orgEmail = document.getElementById('orgEmail').value;
            const maxRegs = document.getElementById('maxRegistrations').value;

            alert('Settings saved successfully!');
        }

        // Utility functions
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function () {
            // Load initial content
            loadKiosks();
            updateDashboardStats();

            // Close modals when clicking outside
            window.onclick = function (event) {
                const modals = document.getElementsByClassName('modal');
                for (let modal of modals) {
                    if (event.target === modal) {
                        modal.style.display = 'none';
                    }
                }
            }
        });
    </script>
</body>

</html>